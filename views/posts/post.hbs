{{!-- post section --}}
<div class="post-owner row my-3">
  <div class="img-section col-lg-1 col-sm-2 me-1 p-0">
    <a href="/accounts/{{post.userId}}"><img src={{post.userAvatar}} alt="avatar"></a>
  </div>
  <div class="col">
    <h4 class="m-0">{{post.username}}</h4>
    <p class="created-time m-0">{{post.createdDateTime}} 建立</p>
    <p class="updated-time m-0">{{post.updatedDateTime}} 更新</p>
  </div>
  {{#if post.myPost}}
  <div class="col-auto d-flex mt-auto">
    <button id="edit-button">
      <i class="fa-solid fa-pen"></i>
    </button>
    <button id="delete-button" class="text-danger" data-bs-toggle="modal" data-bs-target="#deletePostAlert">
      <i class="fa-solid fa-trash"></i>
    </button>
  </div>
  {{/if}}
</div>
<div class="post-title mt-1">
  {{!-- read status --}}
  <h2 id="post-title" class="text-dark fw-bold">{{post.title}}</h2>
  {{!-- edit status --}}
  <form id="post-editing" class="hidden" action="/posts/{{post.id}}?_method=PUT" method="POST">
    <div class="mb-1">
      <input type="text" id="title-editing" name="title" class="form-control text-dark fs-5 fw-bold" maxlength="70"
        required>
    </div>
    <div>
      <textarea id="body-editing" name="body" class="form-control" rows="10" maxlength="100000"></textarea>
    </div>
    <div class="d-flex mt-4">
      <button id="cancel-button" type="button" class="btn btn-secondary ms-auto" data-bs-dismiss="modal">取消</button>
      <button type="submit" class="btn btn-primary ms-3">儲存</button>
    </div>
  </form>

</div>
<div class="post-body">
  <p id="post-body">{{post.body}}</p>
</div>

{{!-- reply section --}}
<h4>留言</h4>
{{#each replies}}
<div class="post-reply p-1 mb-2">
  <div class="reply-owner row my-3">
    <div class="img-section col-lg-1 col-sm-2 ms-4 me-1 p-0">
      <a href="/accounts/{{this.replierId}}"><img src={{this.replierAvatar}} alt="avatar"></a>
    </div>
    <div class="col">
      <h5 class="m-0 fs-5">{{this.replierName}}</h5>
      <div class="d-flex">
        <p class="created-time m-0">{{this.createdDateTime}}</p>
        {{#if this.myReply}}
        <button id="delete-button" class="text-danger ms-3" data-bs-toggle="modal" data-bs-target="#deleteReplyAlert"
          data-bs-reply-id="{{this.id}}">
          <i class="fa-solid fa-trash"></i>
        </button>
        {{/if}}
      </div>
    </div>
  </div>
  <div class="reply-body ms-2">
    <p>{{this.body}}</p>
  </div>
</div>
{{/each}}

{{#if user}}
<div class="my-reply mt-3 p-1">
  <div class="my-info row mt-3">
    <div class="img-section col-lg-1 col-sm-2 ms-4 me-1 p-0">
      <a href="/accounts/{{user.id}}"><img src={{user.avatar}} alt="avatar"></a>
    </div>
    <h5 class="col my-auto fs-4">{{user.name}}</h5>
  </div>
  <form action="/posts/{{post.id}}/replies" method="POST" class="reply-form mx-3">
    <label for="reply" class="form-label"></label>
    <textarea name="reply" class="form-control" id="reply" rows="6" maxlength="100000" placeholder="我想留言..."></textarea>
    <div class="text-end mt-4 mb-3">
      <button type="submit" class="btn btn-primary">送出</button>
    </div>
  </form>
</div>
{{else}}
<div class="login-to-reply mt-3 p-5 d-flex bg-dark-subtle">
  <a href="/signin" class="btn btn-warning m-auto">登入後留言</a>
</div>
{{/if}}

{{!-- delete post alert modal --}}
<div class="modal fade" id="deletePostAlert" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        <p>確定要刪除文章嗎? 刪除後無法復原:O</p>
        <div class="d-flex">
          <button type="button" class="btn btn-outline-info btn-sm ms-auto" data-bs-dismiss="modal">取消</button>
          <form action="/posts/{{post.id}}?_method=DELETE" method="POST" style="display:inline;" class="mx-2">
            <button type="submit" class="btn btn-outline-danger btn-sm">刪除</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{{!-- delete reply alert modal --}}
<div class="modal fade" id="deleteReplyAlert" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        <p>確定要刪除留言嗎? 刪除後無法復原:O</p>
        <div class="d-flex">
          <button type="button" class="btn btn-outline-info btn-sm ms-auto" data-bs-dismiss="modal">取消</button>
          <form action="/posts/{{post.id}}/replies/:id?_method=DELETE" method="POST" style="display:inline;"
            class="mx-2 form">
            <button type="submit" class="btn btn-outline-danger btn-sm">刪除</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>